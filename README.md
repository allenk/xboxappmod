#Xbox App Mod Script

*Script which let you modify standard Windows 10 Xbox App streaming to PC settings*

##General

This script (written in PowerShell) does the following:

1. Modifies the Windows hosts file to prevent downloading latest version of Xbox App config by Xbox App (makes a backup first)
2. Modifies the actual Xbox App config file (makes a backup first)
3. Launches Xbox App and waits for the process to end (***you can actually play at this step :)*** )
4. Once Xbox App is closed, reverts the changes of hosts file and config file (by restoring backup files)

Xbox App config file (*settings.json*) is modified by searching for Very High profile settings (*GAME_STREAMING_VERY_HIGH_QUALITY_SETTINGS*) and changing it's values accordingly.

Script uses it's own config file (**config.xml**) so you customize values which should then be applied to hosts file and Xbox App config file.

##Prerequisites

In order to even run this script you need to do the following first:

- Change Windows script Execution Policy:
 1. Open PowerShell **as Administrator**
 2. Type `Set-ExecutionPolicy Unrestricted` and confirm it with `Y`
- Make sure that you are logged into your Xbox Live/Microsoft account in the Xbox App and have been using streaming to PC at least once
- Script is started by using `start.bat` - **remember to run it as Administrator!** (Otherwise it won't be able to modify hosts file - more of it in the **Usage** section below)

##Config file

First, take a look at **config.xml** file - in the `<settings>` section you have four settings:

- `<hostsblocker>127.0.0.1 settings.data.microsoft.com</hostsblocker>`
This defines the actual hosts entry that prevents Xbox App from downloading new config - there is not need to modify it, as it currently works. If Microsoft changes the server from  which settings are downloaded and I will not update it yet, feel free to modify by replacing `settings.data.microsoft.com` with something else :)

- `<quality>70</quality>`
General "quality" of the stream - the actual value in the Xbox App config file have another six zeros (so it's 70000000 instead of 70) but it does not match the bitrate so I don't think it's that. I'd like to think of it as of a "percentage of quality" as it doesn't work over 99 anyway :) Suggested max is 70 - above that value the bitrate is starting to exceed 35-40 mbps which causes compression errors and stuttering.

- `<resolution>1080</resolution>`
Resolution of the stream - you can use 480, 720 or 1080. Unfortunately 1440 and 2160 does not work and Xbox reverts back to lower profiles.

- `<framerate>60</framerate>`
Framerate can be set to 30 or 60 - In general I suggest 30 for Xbox 360 games and 60 for Xbox One games (but first check what is the default FPS cap for each game). This is because even if game is capped at 30 FPS, Xbox is streaming 60 FPS by default, pumping bitrate twice as high (basically sending two identical frames for every frame generated by the console). Changing to 30 let you have the same framerate with better quality.

##Usage

1. Modify `config.xml` with desired values
2. Run `start.bat` as Administrator

**Do not run the `xboxappmod.ps1` directly** - instead run the `start.bat` which first checks the administrator permissions and the runs the script on it's own. **Remember to run `start.bat` as Administrator**, otherwise it won't be able to modify hosts file.

You can create a shortcut to `start.bat` and make it always run with Administrator permissions.

After running the script, Xbox App will start automatically. You can then play the game :) After finishing playing close the Xbox App and the script will finish automatically after a while. **Do not close the script manually or it will not restore backups of hosts and settings file!**

Scripts creates two files: `hosts.bak` and `settings.json.bak` - these are backups of modified files. Do not remove them manually if the script is running or it won't be able to restore backups.

Most of the errors should be handled by the script, but if any unhandled error will occur, a file called `lasterror.txt` will be created. You can refer to error inside to check what went wrong. 

If the script does not start, doublecheck the **Prerequisites** section.

---

Please let me know if you find mistakes, bugs or errors.
You can post issues here : https://github.com/kaczorws/xboxappmod/issues
